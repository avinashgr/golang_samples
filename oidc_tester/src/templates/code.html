<html>

<head>
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link href="/assets/css/styles.css" type="text/css" rel="stylesheet" media="screen,projection" />

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body>
    <!--JavaScript at end of body for optimized loading-->
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <div class="container" style="background-color: rgb(250, 212, 43)">
        <div class="section">

            <!--   Icon Section   -->
            <div class="row">
                <form class="col s12 m4" action="{{.tokenurl}}" method="post">
                    <div class="card lime lighten-2 large">
                        <div class="card-content blue-grey-text">
                            <h6 class="center">Code and State</h5>
                            <div class="row">
                                <b>code:</b>
                                <div class="scroll">
                                    {{.code}}
                                </div>
                                <b>state:</b>
                                <div class="scroll">
                                    {{.state}}
                                </div>
                                <input type="hidden" name="code" value="{{.code}}" />
                                <input type="hidden" name="state" value="{{.state}}" />
                            </div>
                            <div class="center">
                                <button id="get-token-button" class="center btn waves-effect waves-light green">Post
                                    Code (Step 4)</button>
                            </div>
                        </div>
                    </div>
                </form>
                <div class="col s12 m8">
                    <h5 class="center black-text">OIDC Flow: Step 3</h5>

                    <p class="light black-text">The Authorization Server has returned a code: {{.code}} and the state as
                        {{.state}}</p>
                    <p class="light black-text">This will need to be POSTED to the Authorization server's token endpoint: {{.token_url}} </p>
                    <p class="light black-text">The Authorization server will use the code along with the client id and
                        secret to return an access and Id token. </p>
    <pre>
        AuthN Response-----
        code {{.code}} and state {{.state}} 
        returned in 
        redirect_uri {{.redirect_uri}}
        +--------+                                                  +--------+
        |        |                                                  |        |
        |        |---------(1) AuthN Request-----------------------&gt;|        |
        |        |                                                  |        |
        |        |  +--------+                                      |        |
        |        |  |        |                                      |        |
        |        |  |  End-  |&lt;--(2) AuthN & AuthZ-----------------&gt;|        |
        |        |  |  User  |                                      |        |
        |   RP   |  |        |                                      |   OP   |
        |        |  +--------+                                      |        |
        |        |                                                  |        |
        |        |&lt;--------(3) AuthN Resp (code)--------------------|        |
        |        |                                                  |        | 
        |        |---------(4) AuthN Req  (code)-------------------&gt;|        |
        |        |                                                  |        |
        |        |&lt;--------(5) AuthN Resp (id,access tokens)--------|        |
        |        |                                                  |        | 
        |        |---------(6) UserInfo Request--(access token)----&gt;|        |
        |        |                                                  |        |
        |        |&lt;--------(7) UserInfo Response--------------------|        |
        |        |                                                  |        |
        +--------+                                                  +--------+
        </pre>
                    
                </div>

            </div>

        </div>
    </div>

</body>

</html>